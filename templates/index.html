{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <!-- Hero Section -->
        <div class="jumbotron bg-primary text-white rounded p-5 mb-5">
            <h1 class="display-4"><i class="fas fa-shield-alt"></i> Product Registry</h1>
            <p class="lead">Secure registration and deal management system to prevent unauthorized resale of stolen camera equipment and other valuable products.</p>
            {% if not current_user.is_authenticated %}
                <hr class="my-4">
                <p class="mb-3">Join our secure platform to protect your valuable equipment and make trustworthy deals.</p>
                <a class="btn btn-light btn-lg me-3" href="{{ url_for('main.register') }}" role="button">
                    <i class="fas fa-user-plus"></i> Register Now
                </a>
                <a class="btn btn-outline-light btn-lg" href="{{ url_for('main.login') }}" role="button">
                    <i class="fas fa-sign-in-alt"></i> Login
                </a>
            {% endif %}
        </div>

        <!-- Features Section -->
        <div class="row mb-5">
            <div class="col-md-4 text-center mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <i class="fas fa-lock fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Secure Registration</h5>
                        <p class="card-text">Register your valuable equipment with unique serial numbers to prevent theft and unauthorized resale.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 text-center mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <i class="fas fa-handshake fa-3x text-success mb-3"></i>
                        <h5 class="card-title">Trusted Deals</h5>
                        <p class="card-text">Create secure deals between verified users. Both buyer and seller must be logged in for transparency.</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 text-center mb-4">
                <div class="card h-100">
                    <div class="card-body">
                        <i class="fas fa-search fa-3x text-info mb-3"></i>
                        <h5 class="card-title">Track & Monitor</h5>
                        <p class="card-text">Track product status, view history, and report stolen items to protect the community.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- How It Works Section -->
        <div class="card mb-5">
            <div class="card-header">
                <h3><i class="fas fa-cogs"></i> How It Works</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h5><i class="fas fa-user text-primary"></i> For Users</h5>
                        <ol>
                            <li>Create an account with username, email, and mobile number</li>
                            <li>Register up to 3 products for free (cameras, lenses, lights, etc.)</li>
                            <li>Manage product status: Lock, Unlock, or Mark as Stolen</li>
                            <li>Create deals with other verified users</li>
                            <li>Track your deal history and product status</li>
                        </ol>
                    </div>
                    <div class="col-md-6">
                        <h5><i class="fas fa-user-shield text-warning"></i> For Admins</h5>
                        <ol>
                            <li>Manage product categories and brands</li>
                            <li>Search products by serial number or user mobile</li>
                            <li>Monitor all users and their registered products</li>
                            <li>View all deals and track stolen items</li>
                            <li>Generate reports for stolen products</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Section (if user is logged in) -->
        {% if current_user.is_authenticated %}
            <div class="card">
                <div class="card-header">
                    <h4><i class="fas fa-chart-bar"></i> Quick Stats</h4>
                </div>
                <div class="card-body">
                    {% if current_user.is_admin %}
                        <div class="row text-center">
                            <div class="col-md-3">
                                <h5 class="text-primary">Users</h5>
                                <p class="h4">{{ current_user.query.filter_by(is_admin=False).count() }}</p>
                            </div>
                            <div class="col-md-3">
                                <h5 class="text-success">Products</h5>
                                <p class="h4">Total Registered</p>
                            </div>
                            <div class="col-md-3">
                                <h5 class="text-info">Deals</h5>
                                <p class="h4">Active</p>
                            </div>
                            <div class="col-md-3">
                                <h5 class="text-danger">Stolen</h5>
                                <p class="h4">Reported</p>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            <a href="{{ url_for('main.admin_dashboard') }}" class="btn btn-primary">
                                <i class="fas fa-tachometer-alt"></i> Go to Admin Dashboard
                            </a>
                        </div>
                    {% else %}
                        <div class="row text-center">
                            <div class="col-md-4">
                                <h5 class="text-primary">Your Products</h5>
                                <p class="h4">{{ current_user.products|length }}</p>
                            </div>
                            <div class="col-md-4">
                                <h5 class="text-success">Free Slots</h5>
                                <p class="h4">{{ 3 - current_user.products|length if current_user.products|length < 3 else 0 }}</p>
                            </div>
                            <div class="col-md-4">
                                <h5 class="text-info">Subscription</h5>
                                <p class="h4">{{ 'Active' if current_user.has_subscription else 'None' }}</p>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            <a href="{{ url_for('main.user_dashboard') }}" class="btn btn-primary">
                                <i class="fas fa-tachometer-alt"></i> Go to Dashboard
                            </a>
                            {% if current_user.can_register_product() %}
                                <a href="{{ url_for('main.register_product') }}" class="btn btn-success">
                                    <i class="fas fa-plus"></i> Register Product
                                </a>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
